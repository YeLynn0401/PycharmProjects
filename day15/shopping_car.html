<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>我的购物车 - 京东商城</title>
    <link href="css/car.css" rel="stylesheet">
</head>
<body>
<div class="top">
    <div class="w" style="padding: 15px 0 10px;">
        <div class="" style="position: relative;">
            <img class="" src="images/logo_car.png">
            <div class=""
                 style="position: absolute; display: inline-block;width:100px;height:40px;background:#fff;line-height:40px;left: 170px;top: 10px;">
                <b style="font-size: 20px;margin-left: 20px;">购物车</b>
            </div>
            <div class="" style="display: inline-block;position: absolute; right: 0;top: 22px;border: 2px solid #c91623;
    background: #c91623;">
                <input type="text" style="border: 0;height: 18px;line-height: 18px;width: 260px;padding: 4px 5px;"
                       placeholder="自营">
                <input type="button"
                       style="width:48px;height: 24px;background: #c91623;text-align: center;color: #fff;font-weight: 700;border: 0"
                       value="搜索">
            </div>
        </div>
    </div>

</div>
<div class="w" style="margin-top: 20px;margin-bottom: 10px">
    <span style="font-weight: 700;font-size: 16px;margin-right: 20px;color: red">全部商品</span>
    <span style="font-weight: 700;font-size: 16px;">京东大药房</span>
</div>
<div class="w"
     style="height: 32px;line-height: 32px;padding: 5px 0;background: #f3f3f3;border: 1px solid #e9e9e9;border-top: 0;">
    <button class="all_select">全选</button>
    <span class="mm1">商品</span>
    <span class="mm2">单价</span>
    <span class="mm2">数量</span>
    <span class="mm2">小计</span>
    <span class="mm2">操作</span>
</div>

<div>
    <div class="w commodity_menu">
        <label><input type="checkbox" class="check_list">科族数码专营店</label>
    </div>
    <div class="w commodity_item">
        <div class="commodity_info">
            <div class="commodity_check">
                <input class="commodity_checkbox" type="checkbox">
            </div>
            <div>
                <div class="commodity_img">
                    <img src="images/ipad.jpg">
                </div>
                <div class="commodity_text">
                    <a href="#">
                        【 京东仓直发 六期免息】Apple苹果 iPad Air 2平板电脑 9.7英寸 金色 32G-WLAN版
                    </a>
                </div>
                <div class="commodity_return_text">
                    <span>
                        <i></i>
                        <a href="#">支持7天无理由退货</a>
                    </span>
                    <span></span>
                </div>
            </div>
        </div>
        <div class="commodity_config">
            <div>颜色：金色</div>
            <div>尺码：32G-WLAN版</div>
        </div>
        <div class="commodity_price">
            ¥<strong class="unit_price">3008.00</strong>
        </div>
        <div class="commodity_total">
            <div class="box">
                <a class="less">-</a>
                <input class="text_num" autocomplete="off" type="text" value="0">
                <a class="plus">+</a>
            </div>
            <div class="status">有货</div>
        </div>
        <div class="commodity_price_count">
            ¥<strong class="price_count">0.00</strong>
        </div>
        <div class="delete">
            <strong>&nbsp;&nbsp;删除</strong>
        </div>
        <div style="clear: both"></div>
    </div>
</div>
<div>
    <div class="w commodity_menu">
        <label><input type="checkbox" class="check_list">科族数码专营店</label>
    </div>
    <div class="w commodity_item">
        <div class="commodity_info">
            <div class="commodity_check">
                <input class="commodity_checkbox" type="checkbox">
            </div>
            <div>
                <div class="commodity_img">
                    <img src="images/ipad.jpg">
                </div>
                <div class="commodity_text">
                    <a href="#">
                        【 京东仓直发 六期免息】Apple苹果 iPad Air 2平板电脑 9.7英寸 金色 32G-WLAN版
                    </a>
                </div>
                <div class="commodity_return_text">
                    <span>
                        <i></i>
                        <a href="#">支持7天无理由退货</a>
                    </span>
                    <span></span>
                </div>
            </div>
        </div>
        <div class="commodity_config">
            <div>颜色：金色</div>
            <div>尺码：32G-WLAN版</div>
        </div>
        <div class="commodity_price">
            ¥<strong class="unit_price">3008.00</strong>
        </div>
        <div class="commodity_total">
            <div class="box">
                <a class="less">-</a>
                <input class="text_num" autocomplete="off" type="text" value="0">
                <a class="plus">+</a>
            </div>
            <div class="status">有货</div>
        </div>
        <div class="commodity_price_count">
            ¥<strong class="price_count">0.00</strong>
        </div>
        <div class="delete">
            <strong>&nbsp;&nbsp;删除</strong>
        </div>
        <div style="clear: both"></div>
    </div>
    <div class="w commodity_item">
        <div class="commodity_info">
            <div class="commodity_check">
                <input class="commodity_checkbox" type="checkbox">
            </div>
            <div>
                <div class="commodity_img">
                    <img src="images/ipad.jpg">
                </div>
                <div class="commodity_text">
                    <a href="#">
                        【 京东仓直发 六期免息】Apple苹果 iPad Air 2平板电脑 9.7英寸 金色 32G-WLAN版
                    </a>
                </div>
                <div class="commodity_return_text">
                    <span>
                        <i></i>
                        <a href="#">支持7天无理由退货</a>
                    </span>
                    <span></span>
                </div>
            </div>
        </div>
        <div class="commodity_config">
            <div>颜色：金色</div>
            <div>尺码：32G-WLAN版</div>
        </div>
        <div class="commodity_price">
            ¥<strong class="unit_price">3008.00</strong>
        </div>
        <div class="commodity_total">
            <div class="box">
                <a class="less">-</a>
                <input class="text_num" autocomplete="off" type="text" value="0">
                <a class="plus">+</a>
            </div>
            <div class="status">有货</div>
        </div>
        <div class="commodity_price_count">
            ¥<strong class="price_count">0.00</strong>
        </div>
        <div class="delete">
            <strong>&nbsp;&nbsp;删除</strong>
        </div>
        <div style="clear: both"></div>
    </div>
    <div class="w commodity_item">
        <div class="commodity_info">
            <div class="commodity_check">
                <input class="commodity_checkbox" type="checkbox">
            </div>
            <div>
                <div class="commodity_img">
                    <img src="images/ipad.jpg">
                </div>
                <div class="commodity_text">
                    <a href="#">
                        【 京东仓直发 六期免息】Apple苹果 iPad Air 2平板电脑 9.7英寸 金色 32G-WLAN版
                    </a>
                </div>
                <div class="commodity_return_text">
                    <span>
                        <i></i>
                        <a href="#">支持7天无理由退货</a>
                    </span>
                    <span></span>
                </div>
            </div>
        </div>
        <div class="commodity_config">
            <div>颜色：金色</div>
            <div>尺码：32G-WLAN版</div>
        </div>
        <div class="commodity_price">
            ¥<strong class="unit_price">3008.00</strong>
        </div>
        <div class="commodity_total">
            <div class="box">
                <a class="less">-</a>
                <input class="text_num" autocomplete="off" type="text" value="0">
                <a class="plus">+</a>
            </div>
            <div class="status">有货</div>
        </div>
        <div class="commodity_price_count">
            ¥<strong class="price_count">0.00</strong>
        </div>
        <div class="delete">
            <strong>&nbsp;&nbsp;删除</strong>
        </div>
        <div style="clear: both"></div>
    </div>
    <div class="w commodity_item">
        <div class="commodity_info">
            <div class="commodity_check">
                <input class="commodity_checkbox" type="checkbox">
            </div>
            <div>
                <div class="commodity_img">
                    <img src="images/ipad.jpg">
                </div>
                <div class="commodity_text">
                    <a href="#">
                        【 京东仓直发 六期免息】Apple苹果 iPad Air 2平板电脑 9.7英寸 金色 32G-WLAN版
                    </a>
                </div>
                <div class="commodity_return_text">
                    <span>
                        <i></i>
                        <a href="#">支持7天无理由退货</a>
                    </span>
                    <span></span>
                </div>
            </div>
        </div>
        <div class="commodity_config">
            <div>颜色：金色</div>
            <div>尺码：32G-WLAN版</div>
        </div>
        <div class="commodity_price">
            ¥<strong class="unit_price">3008.00</strong>
        </div>
        <div class="commodity_total">
            <div class="box">
                <a class="less">-</a>
                <input class="text_num" autocomplete="off" type="text" value="0">
                <a class="plus">+</a>
            </div>
            <div class="status">有货</div>
        </div>
        <div class="commodity_price_count">
            ¥<strong class="price_count">0.00</strong>
        </div>
        <div class="delete">
            <strong>&nbsp;&nbsp;删除</strong>
        </div>
        <div style="clear: both"></div>
    </div>
</div>
<div>
    <div class="w commodity_menu">
        <label><input type="checkbox" class="check_list">科族数码专营店</label>
    </div>
    <div class="w commodity_item">
        <div class="commodity_info">
            <div class="commodity_check">
                <input class="commodity_checkbox" type="checkbox">
            </div>
            <div>
                <div class="commodity_img">
                    <img src="images/ipad.jpg">
                </div>
                <div class="commodity_text">
                    <a href="#">
                        【 京东仓直发 六期免息】Apple苹果 iPad Air 2平板电脑 9.7英寸 金色 32G-WLAN版
                    </a>
                </div>
                <div class="commodity_return_text">
                    <span>
                        <i></i>
                        <a href="#">支持7天无理由退货</a>
                    </span>
                    <span></span>
                </div>
            </div>
        </div>
        <div class="commodity_config">
            <div>颜色：金色</div>
            <div>尺码：32G-WLAN版</div>
        </div>
        <div class="commodity_price">
            ¥<strong class="unit_price">3008.00</strong>
        </div>
        <div class="commodity_total">
            <div class="box">
                <a class="less">-</a>
                <input class="text_num" autocomplete="off" type="text" value="0">
                <a class="plus">+</a>
            </div>
            <div class="status">有货</div>
        </div>
        <div class="commodity_price_count">
            ¥<strong class="price_count">0.00</strong>
        </div>
        <div class="delete">
            <strong>&nbsp;&nbsp;删除</strong>
        </div>
        <div style="clear: both"></div>
    </div>
</div>
<div>
    <div class="w commodity_menu">
        <label><input type="checkbox" class="check_list">科族数码专营店</label>
    </div>
    <div class="w commodity_item">
        <div class="commodity_info">
            <div class="commodity_check">
                <input class="commodity_checkbox" type="checkbox">
            </div>
            <div>
                <div class="commodity_img">
                    <img src="images/ipad.jpg">
                </div>
                <div class="commodity_text">
                    <a href="#">
                        【 京东仓直发 六期免息】Apple苹果 iPad Air 2平板电脑 9.7英寸 金色 32G-WLAN版
                    </a>
                </div>
                <div class="commodity_return_text">
                    <span>
                        <i></i>
                        <a href="#">支持7天无理由退货</a>
                    </span>
                    <span></span>
                </div>
            </div>
        </div>
        <div class="commodity_config">
            <div>颜色：金色</div>
            <div>尺码：32G-WLAN版</div>
        </div>
        <div class="commodity_price">
            ¥<strong class="unit_price">3008.00</strong>
        </div>
        <div class="commodity_total">
            <div class="box">
                <a class="less">-</a>
                <input class="text_num" autocomplete="off" type="text" value="0">
                <a class="plus">+</a>
            </div>
            <div class="status">有货</div>
        </div>
        <div class="commodity_price_count">
            ¥<strong class="price_count">0.00</strong>
        </div>
        <div class="delete">
            <strong>&nbsp;&nbsp;删除</strong>
        </div>
        <div style="clear: both"></div>
    </div>
    <div class="w commodity_item">
        <div class="commodity_info">
            <div class="commodity_check">
                <input class="commodity_checkbox" type="checkbox">
            </div>
            <div>
                <div class="commodity_img">
                    <img src="images/ipad.jpg">
                </div>
                <div class="commodity_text">
                    <a href="#">
                        【 京东仓直发 六期免息】Apple苹果 iPad Air 2平板电脑 9.7英寸 金色 32G-WLAN版
                    </a>
                </div>
                <div class="commodity_return_text">
                    <span>
                        <i></i>
                        <a href="#">支持7天无理由退货</a>
                    </span>
                    <span></span>
                </div>
            </div>
        </div>
        <div class="commodity_config">
            <div>颜色：金色</div>
            <div>尺码：32G-WLAN版</div>
        </div>
        <div class="commodity_price">
            ¥<strong class="unit_price">3008.00</strong>
        </div>
        <div class="commodity_total">
            <div class="box">
                <a class="less">-</a>
                <input class="text_num" autocomplete="off" type="text" value="0">
                <a class="plus">+</a>
            </div>
            <div class="status">有货</div>
        </div>
        <div class="commodity_price_count">
            ¥<strong class="price_count">0.00</strong>
        </div>
        <div class="delete">
            <strong>&nbsp;&nbsp;删除</strong>
        </div>
        <div style="clear: both"></div>
    </div>
    <div class="w commodity_item">
        <div class="commodity_info">
            <div class="commodity_check">
                <input class="commodity_checkbox" type="checkbox">
            </div>
            <div>
                <div class="commodity_img">
                    <img src="images/ipad.jpg">
                </div>
                <div class="commodity_text">
                    <a href="#">
                        【 京东仓直发 六期免息】Apple苹果 iPad Air 2平板电脑 9.7英寸 金色 32G-WLAN版
                    </a>
                </div>
                <div class="commodity_return_text">
                    <span>
                        <i></i>
                        <a href="#">支持7天无理由退货</a>
                    </span>
                    <span></span>
                </div>
            </div>
        </div>
        <div class="commodity_config">
            <div>颜色：金色</div>
            <div>尺码：32G-WLAN版</div>
        </div>
        <div class="commodity_price">
            ¥<strong class="unit_price">3008.00</strong>
        </div>
        <div class="commodity_total">
            <div class="box">
                <a class="less">-</a>
                <input class="text_num" autocomplete="off" type="text" value="0">
                <a class="plus">+</a>
            </div>
            <div class="status">有货</div>
        </div>
        <div class="commodity_price_count">
            ¥<strong class="price_count">0.00</strong>
        </div>
        <div class="delete">
            <strong>&nbsp;&nbsp;删除</strong>
        </div>
        <div style="clear: both"></div>
    </div>
    <div class="w commodity_item">
        <div class="commodity_info">
            <div class="commodity_check">
                <input class="commodity_checkbox" type="checkbox">
            </div>
            <div>
                <div class="commodity_img">
                    <img src="images/ipad.jpg">
                </div>
                <div class="commodity_text">
                    <a href="#">
                        【 京东仓直发 六期免息】Apple苹果 iPad Air 2平板电脑 9.7英寸 金色 32G-WLAN版
                    </a>
                </div>
                <div class="commodity_return_text">
                    <span>
                        <i></i>
                        <a href="#">支持7天无理由退货</a>
                    </span>
                    <span></span>
                </div>
            </div>
        </div>
        <div class="commodity_config">
            <div>颜色：金色</div>
            <div>尺码：32G-WLAN版</div>
        </div>
        <div class="commodity_price">
            ¥<strong class="unit_price">3008.00</strong>
        </div>
        <div class="commodity_total">
            <div class="box">
                <a class="less">-</a>
                <input class="text_num" autocomplete="off" type="text" value="0">
                <a class="plus">+</a>
            </div>
            <div class="status">有货</div>
        </div>
        <div class="commodity_price_count">
            ¥<strong class="price_count">0.00</strong>
        </div>
        <div class="delete">
            <strong>&nbsp;&nbsp;删除</strong>
        </div>
        <div style="clear: both"></div>
    </div>
</div>


<div id="bott">
    <div class="w count">
        <button class="all_select">全选</button>
        <span style="float: right">共计：￥<span id="count_all">0</span></span>
    </div>
</div>
<div style="height: 800px"></div>
<script src="css/jquery.min.js"></script>
<script>
    s_top = $("#bott").offset().top;
    // 浮动条
    function fix() {
        var w_height = $(window).height();
        if ($(window).scrollTop() < (s_top - w_height)) {
            if (!$("#bott").hasClass("fix")) {
                $("#bott").addClass("fix")
            }
        } else {
            if ($("#bott").hasClass("fix")) {
                $("#bott").removeClass("fix")
            }
        }
    }
    $(function () {
        fix();

    });
    function c() {
        var count = [];
        $(".commodity_checkbox").filter(function (index) {return $(this).prop("checked")}).each(function () {
//            $(this).parents(".commodity_info").siblings(".commodity_price_count").children("price_count")
            count.push($(this).parents(".commodity_info").siblings(".commodity_price_count").children(".price_count").text());
//            console.log($(this).parents(".commodity_info").siblings(".commodity_price_count").children(".price_count").text())
        });
//        console.log(count);
        var c = 0;
        for(var i=0; i<count.length;i++){
            c += Number(count[i])
        }
//        console.log(c)
        $("#count_all").text(c)

    }
    // 总计框浮动
    $(window).scroll(function () {
        fix()
    });
    // 商品数量减
    $(".less").click(function () {

        var a = $(this).next("input");
        var n = parseInt(a.val());
        if(n){
            if(n >0){
                a.val(parseInt(a.val())-1);
            }else {
                a.val(0);
            }
        }else {
            if(n !=0){
                a.val(0);
            }
        }
        // 计算价格
        var count = price_count(this);
        $(this).parents(".commodity_total").siblings(".commodity_price_count").children(".price_count").text(count);
        c();
    });
    // 商品数量加
    $(".plus").click(function () {

        var a = $(this).prev("input");
        var n = parseInt(a.val());
        if(n){
            if(n >0){
                a.val(parseInt(a.val())+1);
            }else {
                a.val(1);
            }
        }else {
            a.val(1);
        }
        // 计算价格
        var count = price_count(this);
        $(this).parents(".commodity_total").siblings(".commodity_price_count").children(".price_count").text(count);
        c()
    });
    // 删除商品
    $(".delete").click(function () {
//        console.log(($(this).parent(".commodity_item").siblings(".commodity_item")).length);
//        $(this).parent(".commodity_item").remove();
        if(($(this).parent(".commodity_item").siblings(".commodity_item")).length){
            $(this).parent(".commodity_item").remove();
        }else {
            $(this).parent(".commodity_item").parent().remove();
        }
        c()
    });
    // 全选
    $(".all_select").click(function () {
        if($("input[type='checkbox']").prop("checked")){
            $("input[type='checkbox']").prop("checked",false);
        }else {
            $("input[type='checkbox']").prop("checked",true);
        }
        c();
    });
    // 店铺下商品全选中，店铺自动选中
    $(".commodity_checkbox").click(function () {

        var a = $(this).parents(".commodity_item").siblings(".commodity_item");
//        console.log(a.length);
        if ($(this).prop("checked")){
            if(a.length){
//                console.log(a.find("input[class='commodity_checkbox']"))
                if(a.find(".commodity_checkbox").length ==  a.find(".commodity_checkbox").filter(function () {
                        return $(this).prop("checked")
                    }).length){
                    $(this).parents(".commodity_item").siblings(".commodity_menu").find("input[type='checkbox']").prop("checked",true);
            }
            }else {
                //店铺里只买了一个商品
                $(this).parents(".commodity_item").siblings(".commodity_menu").find("input[type='checkbox']").prop("checked",true);
            }
        }else {
            $(this).parents(".commodity_item").siblings(".commodity_menu").find("input[type='checkbox']").prop("checked",false);
        }
        c();
//        if($(this).prop("checked")){
//            console.log($(this).parents(".commodity_item").siblings(".commodity_menu").find("commodity_checkbox").prop("checked"))
//        }else {
//
//        }
//        console.log($(this).parents(".commodity_item").siblings(".commodity_item").find(".commodity_checkbox").prop("checked"))
    });
    // 勾选店铺，子商品全部选中
    $(".check_list").click(function () {
        if($(this).prop("checked")){
            $(this).parent().parent().siblings(".commodity_item").find("input[type='checkbox']").prop("checked",true);
        }else {
            $(this).parent().parent().siblings(".commodity_item").find("input[type='checkbox']").prop("checked",false);
        }
        c();
    });
    // 检查用户输入的数量
    $(".text_num").blur(function () {
        var num = parseInt($(this).val());
//        console.log(num);
        if(!num){
            num = 0
        }
        parseInt($(this).val(num))
        c();
    });
    // 计算价格
    function price_count(a) {
        // 获取数量
        var num = $(a).siblings("input").val();
//        console.log(num);
        // 获取单价
        var price = $(a).parents(".commodity_total").siblings(".commodity_price").children(".unit_price").text()
//        console.log(price);
        //计算价格
        var count = Number(price)*num;
//        console.log(count);
        return count
    }
    // 计算价格
//    $(this).parents(".commodity_total").siblings(".commodity_price_count").children(".price_count").val()
</script>
</body>
</html>